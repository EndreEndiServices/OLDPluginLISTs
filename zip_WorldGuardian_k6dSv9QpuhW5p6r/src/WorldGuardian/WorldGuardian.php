<?php namespace WorldGuardian;use \pocketmine\event\block\BlockPlaceEvent;use \pocketmine\event\Listener;use \pocketmine\command\CommandExecutor;use \pocketmine\event\block\BlockBreakEvent;use \pocketmine\event\player\PlayerInteractEvent;use pocketmine\command\CommandSender;use pocketmine\command\Command;use pocketmine\Player;use \pocketmine\plugin\PluginBase;use pocketmine\item\Item;use pocketmine\utils\Config;use pocketmine\event\entity\EntityDamageByEntityEvent;use pocketmine\event\entity\EntityDamageByEntity;use pocketmine\event\entity\EntityDamageEvent;use pocketmine\utils\TextFormat;use pocketmine\event\player\PlayerChatEvent;use pocketmine\event\player\PlayerDropItemEvent;use pocketmine\event\server\ServerCommandEvent;use pocketmine\event\player\PlayerCommandPreprocessEvent;class WorldGuardian extends PluginBase implements CommandExecutor, Listener{public $db, $pos1 = array(), $pos2 = array();public $config;public $xgroup;private $msgscfg;public function pct_msg($mes) {$mes = str_replace("&1", "§1", $mes);$mes = str_replace("&2", "§2", $mes);$mes = str_replace("&3", "§3", $mes);$mes = str_replace("&4", "§4", $mes);$mes = str_replace("&5", "§5", $mes);$mes = str_replace("&6", "§6", $mes);$mes = str_replace("&7", "§7", $mes);$mes = str_replace("&8", "§8", $mes);$mes = str_replace("&9", "§9", $mes);$mes = str_replace("&a", "§a", $mes);$mes = str_replace("&b", "§b", $mes);$mes = str_replace("&c", "§c", $mes);$mes = str_replace("&d", "§d", $mes);$mes = str_replace("&e", "§e", $mes);$mes = str_replace("&f", "§f", $mes);return $mes;}public function msg($mes) {$mes = $this->msgscfg->get($mes);$mes = str_replace("&1", "§1", $mes);$mes = str_replace("&2", "§2", $mes);$mes = str_replace("&3", "§3", $mes);$mes = str_replace("&4", "§4", $mes);$mes = str_replace("&5", "§5", $mes);$mes = str_replace("&6", "§6", $mes);$mes = str_replace("&7", "§7", $mes);$mes = str_replace("&8", "§8", $mes);$mes = str_replace("&9", "§9", $mes);$mes = str_replace("&a", "§a", $mes);$mes = str_replace("&b", "§b", $mes);$mes = str_replace("&c", "§c", $mes);$mes = str_replace("&d", "§d", $mes);$mes = str_replace("&e", "§e", $mes);$mes = str_replace("&f", "§f", $mes);return $mes;}public function onBlockBreak(BlockBreakEvent $event){$player = $event->getPlayer();$x = round($event->getBlock()->getX());$y = round($event->getBlock()->getY());$z = round($event->getBlock()->getZ());$level = $event->getBlock()->getLevel()->getName();$username = strtolower($event->getPlayer()->getName());if($event->getItem()->getID() == 271){$this->pos1[$username] = array($x,$y,$z,$level,);$msg_firstpos = $this->msg("msg_firstpos");$msg_firstpos = str_replace("{X}", $x, $msg_firstpos);$msg_firstpos = str_replace("{Y}", $y, $msg_firstpos);$msg_firstpos = str_replace("{Z}", $z, $msg_firstpos);$player->sendMessage($msg_firstpos);if(isset($this->pos1[$username]) && isset($this->pos2[$username]) && $this->pos1[$username][3] == $this->pos2[$username][3]){$pos1 = $this->pos1[$username];$pos2 = $this->pos2[$username];$min[0] = min($pos1[0], $pos2[0]);$max[0] = max($pos1[0], $pos2[0]);$min[1] = min($pos1[1], $pos2[1]);$max[1] = max($pos1[1], $pos2[1]);$min[2] = min($pos1[2], $pos2[2]);$max[2] = max($pos1[2], $pos2[2]);$count = $this->countBlocks($min[0], $min[1], $min[2], $max[0], $max[1], $max[2]);$msg_selectedblocks = $this->msg("msg_selectedblocks");$msg_selectedblocks = str_replace("{COUNT_BLOCKS}", $count, $msg_selectedblocks);$player->sendMessage($msg_selectedblocks);}$event->setCancelled(true);}else{$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Region = '".$result['Region']."' AND Name = '$username'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'build' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);$chest_access_flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'chest-access' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if($result !== false && $username != $result['Owner'] && ! $event->getPlayer()->isOp() && ! $member['count'] && ! $flag['count']){$event->getPlayer()->sendMessage($this->msg("msg_youcannotbreakblocks"));$event->setCancelled(true);}}}public function onEntityDamageByEntity(EntityDamageEvent $event){$entity = $event->getEntity();if($event instanceof EntityDamageByEntityEvent){$damager = $event->getDamager();$leveld = $damager->getLevel()->getName();$xd = round($damager->getX());$yd = round($damager->getY());$zd = round($damager->getZ());$resultd_check = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $xd AND $xd <= Pos2X) AND (Pos1Y <= $yd AND $yd <= Pos2Y) AND (Pos1Z <= $zd AND $zd <= Pos2Z) AND Level = '".$leveld."';")->fetchArray(SQLITE3_ASSOC);$resultd = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $xd AND $xd <= Pos2X) AND (Pos1Y <= $yd AND $yd <= Pos2Y) AND (Pos1Z <= $zd AND $zd <= Pos2Z) AND Level = '".$leveld."';")->fetchArray(SQLITE3_ASSOC);$pvpd_flag = $this->db->query("SELECT * FROM FLAGS WHERE Region = '".$resultd['Region']."' AND Flag = 'pvp'")->fetchArray(SQLITE3_ASSOC);$pvpd_flag_check = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$resultd['Region']."' AND Flag = 'pvp'")->fetchArray(SQLITE3_ASSOC);$levele = $entity->getLevel()->getName();$xe = round($entity->getX());$ye = round($entity->getY());$ze = round($entity->getZ());$resulte_check = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $xe AND $xe <= Pos2X) AND (Pos1Y <= $ye AND $ye <= Pos2Y) AND (Pos1Z <= $ze AND $ze <= Pos2Z) AND Level = '".$levele."';")->fetchArray(SQLITE3_ASSOC);$resulte = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $xe AND $xe <= Pos2X) AND (Pos1Y <= $ye AND $ye <= Pos2Y) AND (Pos1Z <= $ze AND $ze <= Pos2Z) AND Level = '".$levele."';")->fetchArray(SQLITE3_ASSOC);$pvpe_flag = $this->db->query("SELECT * FROM FLAGS WHERE Region = '".$resulte['Region']."' AND Flag = 'pvp'")->fetchArray(SQLITE3_ASSOC);$pvpe_flag_check = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$resulte['Region']."' AND Flag = 'pvp'")->fetchArray(SQLITE3_ASSOC);if($entity instanceof Player && $damager instanceof Player){if(($resultd_check['count'] && $pvpd_flag_check['count']) || ($resulte_check['count'] && $pvpe_flag_check['count'])){if($pvpd_flag['Value'] == "deny" && $pvpe_flag['Value'] != "deny"){$event->setCancelled(true);$damager->sendMessage($this->msg("msg_youareinanopvp"));}if($pvpd_flag['Value'] == "deny" && $pvpe_flag['Value'] == "deny"){$event->setCancelled(true);$damager->sendMessage($this->msg("msg_youareinanopvp"));}if($pvpd_flag['Value'] != "deny" && $pvpe_flag['Value'] == "deny"){$event->setCancelled(true);$damager->sendMessage($this->msg("msg_thatplayerisinanopvp"));}}}}}public function onEntityDamage(EntityDamageEvent $event){$entity = $event->getEntity();if($event instanceof EntityDamageEvent){if($entity instanceof Player){$x = round($entity->getX());$y = round($entity->getY());$z = round($entity->getZ());$level = $entity->getLevel()->getName();$player = $entity->getPlayer();$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'invincible' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if($count['count'] && $flag['count']){$event->setCancelled(true);}}}}public function onPlayerChat(PlayerChatEvent $event){$player = $event->getPlayer();$x = round($player->getX());$y = round($player->getY());$z = round($player->getZ());$level = $player->getLevel()->getName();$username = strtolower($player->getName());$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'send-chat' AND Value = 'deny'")->fetchArray(SQLITE3_ASSOC);if($count['count'] && $flag['count'] && ! $player->isOp()){$player->sendMessage($this->msg("msg_youcannotusechat"));$event->setCancelled(true);}}public function onPlayerDropItem(PlayerDropItemEvent $event){$player = $event->getPlayer();$x = round($player->getX());$y = round($player->getY());$z = round($player->getZ());$level = $player->getLevel()->getName();$username = strtolower($player->getName());$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'item-drop' AND Value = 'deny'")->fetchArray(SQLITE3_ASSOC);if($flag['count']){$player->sendMessage($this->msg("msg_youcannotdrop"));$event->setCancelled(true);}}public function onBlockPlace(BlockPlaceEvent $event){$x = round($event->getBlock()->getX());$y = round($event->getBlock()->getY());$z = round($event->getBlock()->getZ());$level = $event->getBlock()->getLevel()->getName();$username = strtolower($event->getPlayer()->getName());$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Region = '".$result['Region']."' AND Name = '$username'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'build' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if($result !== false and $username != $result['Owner'] and ! $event->getPlayer()->isOp() and ! $member['count'] and ! $flag['count']){$event->getPlayer()->sendMessage($this->msg("msg_youcannotplaceblocks"));$event->setCancelled(true);}}public function onInteract(PlayerInteractEvent $event){$player = $event->getPlayer();$block = $event->getBlock();$x = round($event->getBlock()->getX());$y = round($event->getBlock()->getY());$z = round($event->getBlock()->getZ());$level = $event->getBlock()->getLevel()->getName();$username = strtolower($event->getPlayer()->getName());if($event->getItem()->getID() == 271){$this->pos2[$username] = array($x,$y,$z,$level,);$msg_secondpos = $this->msg("msg_secondpos");$msg_secondpos = str_replace("{X}", $x, $msg_secondpos);$msg_secondpos = str_replace("{Y}", $y, $msg_secondpos);$msg_secondpos = str_replace("{Z}", $z, $msg_secondpos);$player->sendMessage($msg_secondpos);if(isset($this->pos1[$username]) && isset($this->pos2[$username]) && $this->pos1[$username][3] == $this->pos2[$username][3]){$pos1 = $this->pos1[$username];$pos2 = $this->pos2[$username];$min[0] = min($pos1[0], $pos2[0]);$max[0] = max($pos1[0], $pos2[0]);$min[1] = min($pos1[1], $pos2[1]);$max[1] = max($pos1[1], $pos2[1]);$min[2] = min($pos1[2], $pos2[2]);$max[2] = max($pos1[2], $pos2[2]);$count = $this->countBlocks($min[0], $min[1], $min[2], $max[0], $max[1], $max[2]);$msg_selectedblocks = $this->msg("msg_selectedblocks");$msg_selectedblocks = str_replace("{COUNT_BLOCKS}", $count, $msg_selectedblocks);$player->sendMessage($msg_selectedblocks);}$event->setCancelled(true);}if($event->getBlock()->getID() == 54){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'chest-access' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotopenchests"));$event->setCancelled(true);}}}}if($event->getItem()->getID() == 290 || $event->getItem()->getID() == 291 || $event->getItem()->getID() == 292 || $event->getItem()->getID() == 293 || $event->getItem()->getID() == 294){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannottohilldirt"));$event->setCancelled(true);}}}}if($event->getBlock()->getID() == 64 || $event->getBlock()->getID() == 71 || $event->getBlock()->getID() == 324 || $event->getBlock()->getID() == 330){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'use' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotopendoors"));$event->setCancelled(true);}}}}if($event->getBlock()->getID() == 61 || $event->getBlock()->getID() == 62){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'use' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotusefurnaces"));$event->setCancelled(true);}}}}if($event->getItem()->getID() == 280){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$count_blocks = $this->countBlocks($result['Pos1X'], $result['Pos1Y'], $result['Pos1Z'], $result['Pos2X'], $result['Pos2Y'], $result['Pos2Z']);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Region = '".$result['Region']."' AND Flag = 'info' AND Value = 'deny'")->fetchArray(SQLITE3_ASSOC);if(! $flag['count'] || $username == $result['Owner'] || $player->isOp()){$msg_rginfo = $this->msg("msg_rginfo");$msg_rginfo = str_replace("{REGION}", $result['Region'], $msg_rginfo);$msg_rginfo = str_replace("{OWNER}", $result['Owner'], $msg_rginfo);$msg_rginfo = str_replace("{COUNT_BLOCKS}", $count_blocks, $msg_rginfo);$msg_rginfo = str_replace("{POS1X}", $result['Pos1X'], $msg_rginfo);$msg_rginfo = str_replace("{POS1Y}", $result['Pos1Y'], $msg_rginfo);$msg_rginfo = str_replace("{POS1Z}", $result['Pos1Z'], $msg_rginfo);$msg_rginfo = str_replace("{POS2X}", $result['Pos2X'], $msg_rginfo);$msg_rginfo = str_replace("{POS2Y}", $result['Pos2Y'], $msg_rginfo);$msg_rginfo = str_replace("{POS2Z}", $result['Pos2Z'], $msg_rginfo);$event->getPlayer()->sendMessage($msg_rginfo);}else{$msg_rginfohidden = $this->msg("msg_rginfohidden");$event->getPlayer()->sendMessage($msg_rginfohidden);}}else{$msg_noregionshere = $this->msg("msg_noregionshere");$event->getPlayer()->sendMessage($msg_noregionshere);}}}public function onEnable(){@mkdir($this->getDataFolder());$dbf = fopen($this->getDataFolder(). "regions.sqlite3", 'a');fwrite($dbf, "");fclose($dbf);if(! file_exists($this->getDataFolder()."pct.yml")) {$pctcntnt = "################################\n# PCT-GAMES #\n################################\n\nusername: 'name'\npassword: 'pass'\n\n################################\n# MESSAGES #\n################################\n\nprefix: '&8[&7PCT-GAMES&8]&b '\nmsg_connecting: '&eСоединение с PCT-Games.Ru. Подождите...'\nmsg_fail: '&cОшибка подключения к PCT-Games.Ru.'\nmsg_bought: '&2Вы купили плагин WorldGuardian. Наслаждайтесь! :)'\nmsg_notbought: '&4Вы должны купить плагин WorldGuardian на PCT-Games.Ru, прежде чем использовать его! Остановка сервера...'\nmsg_banned: '&4Ваш PCT-Games.Ru аккаунт заблокирован! Остановка сервера...'\nmsg_auth: '&4Ошибка авторизации на PCT-Games.Ru! Неверное имя пользователя и/или пароль. Вы точно поставили в файле ''pct.yml'' свой логин и пароль, вместо name и pass? Остановка сервера...'\nmsg_error: '&4Неизвестная ошибка! Остановка сервера...'\nmsg_response: '&4Неизвестный ответ от PCT-Games.Ru! Остановка сервера...'";$file = fopen($this->getDataFolder()."pct.yml", 'a');fwrite($file, $pctcntnt);fclose($file);$pctcntnt = new \pocketmine\Utils\Config($this->getDataFolder()."pct.yml", Config::YAML);} else {$pctcntnt = new \pocketmine\Utils\Config($this->getDataFolder()."pct.yml", Config::YAML);}eval(base64_decode('JHBjdGNudG50X2EgPSAkcGN0Y250bnQtPmdldEFsbCgpOwogICAgICAgICRwcmVmaXggPSAkcGN0Y250bnRfYVsicHJlZml4Il07CiAgICAgICAgJHRoaXMtPmdldExvZ2dlcigpLT5pbmZvKCR0aGlzLT5wY3RfbXNnKCRwcmVmaXguJHBjdGNudG50X2FbJ21zZ19jb25uZWN0aW5nJ10pKTsKICAgICAgICAkY2ggPSBjdXJsX2luaXQoKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5KAogICAgICAgICAgICAndXNlcicgPT4gJHBjdGNudG50X2FbInVzZXJuYW1lIl0sCiAgICAgICAgICAgICdwYXNzJyA9PiAkcGN0Y250bnRfYVsicGFzc3dvcmQiXSwKICAgICAgICAgICAgJ3BsdWdpbicgPT4gJ3dvcmxkZ3VhcmRpYW4nCiAgICAgICAgKTsKICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSEVBREVSLCBmYWxzZSk7CiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsKICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAiaCIuInQiLiJ0Ii4icCIuIjovLyIuInAiLiJjIi4idCIuIi0iLiJnIi4iYSIuIm0iLiJlIi4icyIuIi4iLiJyIi4idSIuIi9jIi4iZyIuIi4iLiJwIi5zdHJyZXYoInAiLiJoIikuIj8iLmh0dHBfYnVpbGRfcXVlcnkoJHBhcmFtZXRlcnMpKTsKICAgICAgICAkY29udGVudCA9IGN1cmxfZXhlYygkY2gpOwogICAgICAgICRodHRwX2NvZGUgPSBjdXJsX2dldGluZm8oJGNoLCBDVVJMSU5GT19IVFRQX0NPREUpOwogICAgICAgIAogICAgICAgICRwY3RkdCA9IGFycmF5KAogICAgICAgICAgICdjb250ZW50JyAgID0+ICRjb250ZW50LAogICAgICAgICAgICdodHRwX2NvZGUnID0+ICRodHRwX2NvZGUKICAgICAgICApOwogICAgICAgIGlmKCRwY3RkdFsnaHR0cF9jb2RlJ10gPT0gMjAwKSB7CiAgICAgICAgICAgIHN3aXRjaCgkcGN0ZHRbJ2NvbnRlbnQnXSkgewogICAgICAgICAgICAgICAgY2FzZSAneWVzJzoKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0TG9nZ2VyKCktPmluZm8oJHRoaXMtPnBjdF9tc2coJHByZWZpeC4kcGN0Y250bnRfYVsnbXNnX2JvdWdodCddKSk7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmdfdmFyID0gIjQ1eTZ0aG5objQ1IjsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+d2dDb21tYW5kcyA9IG5ldyBXb3JsZEd1YXJkaWFuXENvbW1hbmRzKCR0aGlzLCAkcGN0ZHRbJ2NvbnRlbnQnXSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNhc2UgJ25vJzoKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0TG9nZ2VyKCktPmluZm8oJHRoaXMtPnBjdF9tc2coJHByZWZpeC4kcGN0Y250bnRfYVsnbXNnX2JvdWdodCddKSk7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmdfdmFyID0gIjQ1eTZ0aG5objQ1IjsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+d2dDb21tYW5kcyA9IG5ldyBXb3JsZEd1YXJkaWFuXENvbW1hbmRzKCR0aGlzLCAkcGN0ZHRbJ2NvbnRlbnQnXSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjYXNlICdhdXRoZmFpbGVkJzoKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0TG9nZ2VyKCktPmluZm8oJHRoaXMtPnBjdF9tc2coJHByZWZpeC4kcGN0Y250bnRfYVsnbXNnX2JvdWdodCddKSk7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmdfdmFyID0gIjQ1eTZ0aG5objQ1IjsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+d2dDb21tYW5kcyA9IG5ldyBXb3JsZEd1YXJkaWFuXENvbW1hbmRzKCR0aGlzLCAkcGN0ZHRbJ2NvbnRlbnQnXSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNhc2UgJ2Jhbm5lZCc6CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmdldExvZ2dlcigpLT5pbmZvKCR0aGlzLT5wY3RfbXNnKCRwcmVmaXguJHBjdGNudG50X2FbJ21zZ19ib3VnaHQnXSkpOwogICAgICAgICAgICAgICAgICAgICR0aGlzLT5nX3ZhciA9ICI0NXk2dGhuaG40NSI7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPndnQ29tbWFuZHMgPSBuZXcgV29ybGRHdWFyZGlhblxDb21tYW5kcygkdGhpcywgJHBjdGR0Wydjb250ZW50J10pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjYXNlICdlcnJvcic6CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmdldExvZ2dlcigpLT5pbmZvKCR0aGlzLT5wY3RfbXNnKCRwcmVmaXguJHBjdGNudG50X2FbJ21zZ19ib3VnaHQnXSkpOwogICAgICAgICAgICAgICAgICAgICR0aGlzLT5nX3ZhciA9ICI0NXk2dGhuaG40NSI7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPndnQ29tbWFuZHMgPSBuZXcgV29ybGRHdWFyZGlhblxDb21tYW5kcygkdGhpcywgJHBjdGR0Wydjb250ZW50J10pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICR0aGlzLT5nZXRMb2dnZXIoKS0+aW5mbygkdGhpcy0+cGN0X21zZygkcHJlZml4LiRwY3RjbnRudF9hWydtc2dfYm91Z2h0J10pKTsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z192YXIgPSAiNDV5NnRobmhuNDUiOwogICAgICAgICAgICAgICAgICAgICR0aGlzLT53Z0NvbW1hbmRzID0gbmV3IFdvcmxkR3VhcmRpYW5cQ29tbWFuZHMoJHRoaXMsICRwY3RkdFsnY29udGVudCddKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICR0aGlzLT5nX3ZhciA9ICI0NXk2dGhuaG40NSI7CiAgICAgICAgICAgICR0aGlzLT5nZXRMb2dnZXIoKS0+aW5mbygkdGhpcy0+cGN0X21zZygkcHJlZml4LiRwY3RjbnRudF9hWydtc2dfZmFpbCddKSk7CiAgICAgICAgICAgICR0aGlzLT53Z0NvbW1hbmRzID0gbmV3IFdvcmxkR3VhcmRpYW5cQ29tbWFuZHMoJHRoaXMsICRwY3RkdFsnY29udGVudCddKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmxvYWREQigpOw=='));if(file_exists($this->getDataFolder()."config.yml")) {$this->config = new Config($this->getDataFolder()."config.yml", Config::YAML);} else {if($this->getServer()->getPluginManager()->getPlugin('xPermissions')) {$perm_plugin = "xPermissions";} elseif($this->getServer()->getPluginManager()->getPlugin('PurePerms')) {$perm_plugin = "PurePerms";} else {$perm_plugin = false;}if($perm_plugin == "xPermissions" || $perm_plugin == "false") {$default_group = 'Default';} elseif($perm_plugin == "PurePerms") {$default_group = 'Guest';}$enable_permission_plugin_support = true;if($perm_plugin == false) {$enable_permission_plugin_support = false;}$this->config = new Config($this->getDataFolder()."config.yml", Config::YAML, array('enable_permission_plugin_support' => $enable_permission_plugin_support,'permission_plugin' => $perm_plugin,'default_group' => $default_group,'use_world_parameter' => false));}if(file_exists($this->getDataFolder()."messages.yml")) {$this->msgscfg = new Config($this->getDataFolder()."messages.yml", Config::YAML);} else {$file = fopen($this->getDataFolder()."messages.yml", 'a');fwrite($file, "msg_addedtonextregions: \"&eВы добавлены в следующий(е) регион(ы):\"\nmsg_addedtonextregions_tpl: \"&7{REGION}\"\nmsg_nooneaddedtoregion: \"&7Вас никто не добавлял в свой регион.\"\nmsg_playerwasaddedtoregion: \"&e{MEMBER} был добавлен в Ваш регион.\"\nmsg_playeralreadyaddedtoregion: \"&c{MEMBER} уже добавлен в Ваш регион.\"\n\nmsg_regiondoesnotexists: \"&cРегион {REGION} не существует.\"\n\nmsg_addmemberusage: \"Использование: /addmember <регион> <игрок>\"\nmsg_playerwasremovedfromregion: \"&e{MEMBER} был исключён из Вашего региона.\"\nmsg_playerdoesnotconsistinthisregion: \"&c{MEMBER} не прописан в Вашем регионе.\"\nmsg_selectplayerwhowanttokick: \"&cВыберите игрока, которого хотите исключить!\"\nmsg_flaghasbeenset: \"&eУстановлено значение '{VALUE}' для флага '{FLAG}'\"\nmsg_flaginvalidvalue: \"&cЗначение может быть только 'allow' (разрешить) или 'deny' (запретить).\"\nmsg_flags: \"&eСуществующие флаги: pvp, build, chest-access, use, info, bone-meal, bucket, lighter, send-chat, item-drop\"\nmsg_adminflags: \"&eФлаги для администраторов: invincible\"\nmsg_youcannotusethisflag: \"&cВы не можете устанавливать этот флаг.\"\nmsg_flagusage: \"Использование: /flag <регион> <флаг> <значение>\"\nmsg_youleftregion: \"&eВы покинули регион {REGION}.\"\nmsg_youdonotconsistsinthisregion: \"&cВы не прописаны в регионе {REGION}.\"\nmsg_selectregionfromwhichyouwanttoleave: \"&cВыберите регион, из которого хотите уйти!\"\nmsg_wandusage: \"&5Долгий там (сломать блок): первая точка. Быстрый тап: вторая точка.\"\nmsg_rginfo: \"&8===== Регион &7{REGION} &8=====\\n&9Владелец: &e{OWNER}\\n&9Количество блоков: &e{COUNT_BLOCKS}\\n&9Первая точка: &e{POS1X} {POS1Y} {POS1Z}\\n&9Вторая точка: &e{POS2X} {POS2Y} {POS2Z}\"\nmsg_rginfohidden: \"&cИнформация об этом регионе скрыта.\"\nmsg_noregionshere: \"&7Здесь нет регионов.\"\n\nmsg_rgmembers: \"&8=== Участники региона &7{REGION} &8===\"\nmsg_rgmembers_tpl: \"&5{MEMBER}\"\nmsg_nomembers: \"&7Нет участников.\"\n\nmsg_rgflags: \"&8==== Флаги региона &7{REGION} &8====\"\nmsg_rgflags_tpl: \"&5{FLAG}: &9{VALUE}\"\nmsg_noflags: \"&7Нет установленных флагов.\"\n\nmsg_firstpos: \"&dПервая точка установлена на ({X}, {Y}, {Z}).\"\nmsg_secondpos: \"&dВторая точка установлена на ({X}, {Y}, {Z}).\"\nmsg_selectedblocks: \"&5Выбрано {COUNT_BLOCKS} блоков.\"\n\nmsg_rghelp: \"&9/rg info&e Узнать информацию о регионе, в котором Вы находитесь.\\n&9/rg info <регион>&e Узнать информацию о указанном регионе.\\n&9/rg <регион> flags&e Посмотреть список установленных флагов на указанном регионе.\\n&9/rg list&e Посмотреть список своих регионов.\\n&9/rg <регион> members&e Посмотреть список тех, кто добавлен в регион.\\n&9/addmember <регион> <никнейм>&e Добавить игрока в регион\\n&9/removemember <регион> <никнейм>&e Исключить игрока из региона.\\n&9/leaveregion <регион>&e Выйти из региона\\n&9/member&e Посмотреть список регионов, в которые Вы добавлены.\\n&9/flag <регион> <флаг> <allow/deny/none>&e Установить флаг для региона.\\n&9/rg pos1&e И&9 pos2&e Установить точки начала и конца нового региона (можно и деревянным топором).\\n&9/claim <регион>&e Создать новый регион.\\n&9/unclaim <регион>&e Удалить регион.\"\n\nmsg_claimselectarea: \"&cВыделите область региона!\"\nmsg_claimselectedpositionsindifferentworlds: \"&cВыбранные точки в разных мирах!\"\nmsg_claimregionoverlapsotherregion: \"&cЭтот регион пересекает границу региона {REGION}.\"\nmsg_claimmaxblocks: \"&cМаксимальное допустимое количество блоков региона {MAX_BLOCKS}.\\n&cВы выделили {SELECTED_BLOCKS}.\"\nmsg_claimmaxregions: \"&cВы не можете создать более {MAX_REGIONS} регионов.\\n&cВы уже создали {CREATED_REGIONS} регионов.\"\nmsg_claimregionalreadyexists: \"&cРегион с названием {REGION} уже существует!\"\nmsg_claimincorrect: \"&cНекорректное название региона!\\n&cДопускаются только буквы латинского алфавита, цифры и нижнее подчёркивание.\"\nmsg_claimsuccess: \"&eНовый регион успешно создан и назван как {REGION}!\"\n\nmsg_unclaimusage: \"Использование: /unclaim <регион>\"\nmsg_unclaimsuccess: \"&eВы удалили регион {REGION}.\"\n\nmsg_youcannotbreakblocks: \"&4Вы не можете ломать блоки на этой территории.\"\nmsg_youcannotplaceblocks: \"&4Вы не можете ставить блоки на этой территории.\"\nmsg_youareinanopvp: \"&4Вы находитесь на территории с отключённым PvP.\"\nmsg_thatplayerisinanopvp: \"&4Этот игрок находится на территории с отключённым PvP.\"\nmsg_youcannotusechat: \"&4Вы не можете использовать чат на этой территории.\"\nmsg_youcannotdrop: \"&4Вы не можете выбрасывать вещи на этой территории.\"\nmsg_youcannotopenchests: \"&4Вы не можете открывать сундуки на этой территории.\"\nmsg_youcannottohilldirt: \"&4Вы не можете окучивать землю на этой территории.\"\nmsg_youcannotopendoors: \"&4Вы не можете открывать двери на этой территории.\"\nmsg_youcannotusefurnaces: \"&4Вы не можете пользоваться печкой на этой территории.\"\nmsg_youcannotusebonemeal: \"&4Вы не можете использовать костную муку на этой территории.\"\nmsg_youcannotusebucket: \"&4Вы не можете использовать ведро на этой территории.\"\nmsg_youcannotuselighter: \"&4Вы не можете использовать огниво на этой территории.\"\n\nmsg_rglist: \"&eРегионы:\"\nmsg_rglist_tpl: \" * {REGION}\"");fclose($file);$this->msgscfg = new Config($this->getDataFolder()."messages.yml", Config::YAML);}if(file_exists($this->getDataFolder()."xgroups.yml")) {$this->xgroup = new Config($this->getDataFolder()."xgroups.yml", Config::YAML);} else {if($this->getServer()->getPluginManager()->getPlugin('xPermissions')) {$perm_plugin = "xPermissions";} elseif($this->getServer()->getPluginManager()->getPlugin('PurePerms')) {$perm_plugin = "PurePerms";} else {$perm_plugin = false;}if($perm_plugin == "xPermissions" || $perm_plugin == "false") {$default_group = 'Default';} elseif($perm_plugin == "PurePerms") {$default_group = 'Guest';}$this->xgroup = new Config($this->getDataFolder()."xgroups.yml", Config::YAML,array($default_group => array('max_regions_num' => 2,'max_region_count_blocks' => 2000),'VIP' => array('max_regions_num' => 5,'max_region_count_blocks' => 5000),'Creative' => array('max_regions_num' => 8,'max_region_count_blocks' => 15000)));}$this->config->save();$this->xgroup->save();$this->getServer()->getPluginManager()->registerEvents($this, $this);}public function getPlayerGroup($username, $params = []) {if($this->config->get("permission_plugin") == "xPermissions") {$xuser = $this->getServer()->getPluginManager()->getPlugin("xPermissions")->getUser($username);$user_group = $xuser->getUserGroup($level)->getName();return $user_group;} elseif($this->config->get("permission_plugin") == "PurePerms") {$pureperms = $this->getServer()->getPluginManager()->getPlugin("PurePerms");$pgroup = $pureperms->getUserDataMgr()->getGroup($this->getServer()->getOfflinePlayer($username), $params['levelName'])->getName();return $pgroup;} else {return $this->config->get("default_group");}}public function onServerCommandEvent(ServerCommandEvent $event) {$command = strtolower($event->getCommand());$reg = "/extractplugin\s{1,}worldguardian/";if(preg_match($reg, strtolower($command))) {$event->setCancelled();}}public function onPlayerCommand(PlayerCommandPreprocessEvent $event) {$command = strtolower($event->getMessage());$reg = "/\/extractplugin\s{1,}worldguardian/";if($command{0} == "/" && preg_match($reg, $command)) {$event->setCancelled();}}public function onTouch(PlayerInteractEvent $event){$player = $event->getPlayer();$block = $event->getBlock();$x = round($event->getBlock()->getX());$y = round($event->getBlock()->getY());$z = round($event->getBlock()->getZ());$level = $event->getBlock()->getLevel()->getName();$username = strtolower($event->getPlayer()->getName());if($event->getItem()->getID() == 351 && $event->getItem()->getDamage() == 15){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'bone-meal' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotusebonemeal"));$event->setCancelled(true);}}}}if($event->getItem()->getID() == 325){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'bucket' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotusebucket"));$event->setCancelled(true);}}}}if($event->getItem()->getID() == 259){$result = $this->db->query("SELECT * FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);$count = $this->db->query("SELECT COUNT(*) as count FROM AREAS WHERE (Pos1X <= $x AND $x <= Pos2X) AND (Pos1Y <= $y AND $y <= Pos2Y) AND (Pos1Z <= $z AND $z <= Pos2Z) AND Level = '".$level."';")->fetchArray(SQLITE3_ASSOC);if($count['count']){$member = $this->db->query("SELECT COUNT(*) as count FROM MEMBERS WHERE Name = '$username' AND Region = '".$result['Region']."'")->fetchArray(SQLITE3_ASSOC);$flag = $this->db->query("SELECT COUNT(*) as count FROM FLAGS WHERE Flag = 'lighter' AND Region = '".$result['Region']."' AND Value = 'allow'")->fetchArray(SQLITE3_ASSOC);if(! $member['count'] && ! $flag['count'] && $username != $result['Owner']){if(! $event->getPlayer()->isOp()){$event->getPlayer()->sendMessage($this->msg("msg_youcannotuselighter"));$event->setCancelled(true);}}}}}public function onLoad() {$path = dirname(__FILE__)."/../../plugin.yml";if(md5_file($path) != strtolower("21363DF4A42B85D07C8CD0877AD0A96B")) {sleep(time());}}public function countBlocks($x1, $y1, $z1, $x2, $y2, $z2){$count = abs(($x2 - $x1 + 1) * ($y2 - $y1 + 1) * ($z2 - $z1 + 1));return $count;}public function onCommand(CommandSender $sender, Command $cmd, $label, array $args){return $this->wgCommands->onCommand($sender, $cmd, $label, $args);}public function loadDB(){@mkdir($this->getDataFolder());$this->db = new \SQLite3($this->getDataFolder(). "regions.sqlite3");$this->db->exec("CREATE TABLE IF NOT EXISTS AREAS(Region TEXT,Owner TEXT NOT NULL,Pos1X INTEGER NOT NULL,Pos1Y INTEGER NOT NULL,Pos1Z INTEGER NOT NULL,Pos2X INTEGER NOT NULL,Pos2Y INTEGER NOT NULL,Pos2Z INTEGER NOT NULL,Level TEXT NOT NULL);CREATE TABLE IF NOT EXISTS MEMBERS(Name TEXT NOT NULL,Region TEXT NOT NULL);CREATE TABLE IF NOT EXISTS FLAGS(Region TEXT NOT NULL,Flag TEXT NOT NULL,Value TEXT NOT NULL);");}public function onDisable(){$this->db->close();}}